CREATE DATABASE BearShopDB
GO
USE BearShopDB
GO


CREATE TABLE Roles (
    Id INT IDENTITY PRIMARY KEY,
    Name NVARCHAR(50) NOT NULL UNIQUE
)

INSERT INTO Roles (Name)
VALUES ('Admin'), ('Customer')



CREATE TABLE Users (
    Id INT IDENTITY PRIMARY KEY,
    Username NVARCHAR(50) NOT NULL UNIQUE,
    Email NVARCHAR(100) NOT NULL UNIQUE,
    PasswordHash NVARCHAR(255) NOT NULL,
    FullName NVARCHAR(100),
    Phone NVARCHAR(20),
    Address NVARCHAR(255),
    RoleId INT NOT NULL,
    IsActive BIT DEFAULT 1,
    CreatedAt DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_Users_Roles FOREIGN KEY (RoleId)
        REFERENCES Roles(Id)
)


CREATE TABLE Categories (
    Id INT IDENTITY PRIMARY KEY,
    Name NVARCHAR(100) NOT NULL,
    IsActive BIT DEFAULT 1
)



CREATE TABLE Products (
    Id INT IDENTITY PRIMARY KEY,
    Name NVARCHAR(150) NOT NULL,
    Description NVARCHAR(MAX),
    Price DECIMAL(18,2) NOT NULL,
    Stock INT NOT NULL,
    ImageUrl NVARCHAR(255),
    CategoryId INT NOT NULL,
    IsActive BIT DEFAULT 1,
    CreatedAt DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_Products_Categories FOREIGN KEY (CategoryId)
        REFERENCES Categories(Id)
)



CREATE TABLE Carts (
    Id INT IDENTITY PRIMARY KEY,
    UserId INT NOT NULL,
    CreatedAt DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_Carts_Users FOREIGN KEY (UserId)
        REFERENCES Users(Id)
)



CREATE TABLE CartItems (
    Id INT IDENTITY PRIMARY KEY,
    CartId INT NOT NULL,
    ProductId INT NOT NULL,
    Quantity INT NOT NULL,
    Price DECIMAL(18,2) NOT NULL,

    CONSTRAINT FK_CartItems_Carts FOREIGN KEY (CartId)
        REFERENCES Carts(Id),

    CONSTRAINT FK_CartItems_Products FOREIGN KEY (ProductId)
        REFERENCES Products(Id)
)


CREATE TABLE Orders (
    Id INT IDENTITY PRIMARY KEY,
    UserId INT NOT NULL,
    TotalAmount DECIMAL(18,2) NOT NULL,
    Status NVARCHAR(50) DEFAULT 'Pending',
    ShippingAddress NVARCHAR(255),
    CreatedAt DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_Orders_Users FOREIGN KEY (UserId)
        REFERENCES Users(Id)
)



CREATE TABLE OrderItems (
    Id INT IDENTITY PRIMARY KEY,
    OrderId INT NOT NULL,
    ProductName NVARCHAR(150) NOT NULL,
    Quantity INT NOT NULL,
    Price DECIMAL(18,2) NOT NULL,

    CONSTRAINT FK_OrderItems_Orders FOREIGN KEY (OrderId)
        REFERENCES Orders(Id)
)


--Insert

INSERT INTO Users
(Username, Email, PasswordHash, FullName, Phone, Address, RoleId)
VALUES
(
    'admin',
    'admin@bearshop.com',
    'hashed_admin_password',
    N'Admin Bear',
    '0900000001',
    N'Hà Nội',
    1
),
(
    'customer1',
    'customer1@gmail.com',
    'hashed_customer_password',
    N'Khách Hàng 1',
    '0900000002',
    N'TP HCM',
    2
);


INSERT INTO Categories (Name)
VALUES
(N'Gấu Teddy'),
(N'Gấu Hoạt Hình'),
(N'Gấu Đôi'),
(N'Gấu Sinh Nhật');


INSERT INTO Products
(Name, Description, Price, Stock, ImageUrl, CategoryId)
VALUES
(
    N'Gấu Teddy Nâu',
    N'Gấu teddy nâu mềm mại, thích hợp làm quà tặng',
    250000,
    20,
    'https://example.com/teddy-brown.jpg',
    1
),
(
    N'Gấu Teddy Trắng',
    N'Gấu teddy trắng dễ thương',
    230000,
    15,
    'https://example.com/teddy-white.jpg',
    1
),
(
    N'Gấu Doraemon',
    N'Gấu bông Doraemon cho fan hoạt hình',
    300000,
    10,
    'https://example.com/doraemon.jpg',
    2
);


INSERT INTO Users
(Username, Email, PasswordHash, FullName, Phone, Address, RoleId)
VALUES
(
    'customer2',
    'customer2@gmail.com',
    'hashed_customer2_password',
    N'Khách Hàng 2',
    '0900000003',
    N'Đà Nẵng',
    2
),
(
    'customer3',
    'customer3@gmail.com',
    'hashed_customer3_password',
    N'Khách Hàng 3',
    '0900000004',
    N'Cần Thơ',
    2
);


INSERT INTO Products
(Name, Description, Price, Stock, ImageUrl, CategoryId)
VALUES
(
    N'Gấu Teddy Hồng',
    N'Gấu teddy màu hồng dành cho bé gái',
    260000,
    18,
    'https://example.com/teddy-pink.jpg',
    1
),
(
    N'Gấu Pooh',
    N'Gấu bông Pooh đáng yêu',
    280000,
    12,
    'https://example.com/pooh.jpg',
    2
),
(
    N'Gấu Đôi Trái Tim',
    N'Gấu đôi ôm trái tim, quà tặng couple',
    450000,
    8,
    'https://example.com/bear-couple.jpg',
    3
),
(
    N'Gấu Sinh Nhật Size Lớn',
    N'Gấu bông size lớn kèm mũ sinh nhật',
    520000,
    5,
    'https://example.com/birthday-bear.jpg',
    4
);



--SELECT * FROM Products
--SELECT * FROM Categories
--SELECT * FROM Users
--SELECT * FROM Carts
--SELECT * FROM CartItems



